{"version":3,"file":"static/js/298.083b047e.chunk.js","mappings":"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","sources":["webpack://my-app/./src/Components/MessagesPage/MessagesMain.module.css?8bf6","img/send.svg","Components/MessagesPage/SendMessages.js","Components/MessagesPage/MessagesFieldMe.js","../node_modules/uuid/dist/esm-browser/native.js","../node_modules/uuid/dist/esm-browser/rng.js","../node_modules/uuid/dist/esm-browser/stringify.js","../node_modules/uuid/dist/esm-browser/v4.js","Components/MessagesPage/MessagesMain.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"header\":\"MessagesMain_header__EMkYa\",\"user\":\"MessagesMain_user__TDMJA\",\"userImg\":\"MessagesMain_userImg__Mop0A\",\"name\":\"MessagesMain_name__58IH7\",\"online\":\"MessagesMain_online__FByeQ\",\"dots\":\"MessagesMain_dots__9N9pU\",\"container\":\"MessagesMain_container__c2E6N\",\"input\":\"MessagesMain_input__R5zJ0\",\"send\":\"MessagesMain_send__tKhge\",\"textArea\":\"MessagesMain_textArea__v6811\",\"messages\":\"MessagesMain_messages__eWIbA\",\"empty\":\"MessagesMain_empty__Un+PR\",\"messagesMe\":\"MessagesMain_messagesMe__Go3UK\",\"messagesFriend\":\"MessagesMain_messagesFriend__4kSKR\",\"messageContainerMe\":\"MessagesMain_messageContainerMe__GIXeF\",\"messageContainerFriend\":\"MessagesMain_messageContainerFriend__6diH7\",\"dateMe\":\"MessagesMain_dateMe__XY83U\",\"dateFriend\":\"MessagesMain_dateFriend__Iu9Pj\",\"dateMessages\":\"MessagesMain_dateMessages__HlrtQ\",\"deletedInput\":\"MessagesMain_deletedInput__caMDW\"};","var _defs, _path, _rect;\nvar _excluded = [\"title\", \"titleId\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport * as React from \"react\";\nfunction SvgSend(_ref, svgRef) {\n  var title = _ref.title,\n    titleId = _ref.titleId,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    fill: \"#ffffff\",\n    id: \"icon\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 32 32\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", null, \".cls-1{fill:none;}\"))), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"send--alt--filled\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M27.71,4.29a1,1,0,0,0-1.05-.23l-22,8a1,1,0,0,0,0,1.87l8.59,3.43L19.59,11,21,12.41l-6.37,6.37,3.44,8.59A1,1,0,0,0,19,28h0a1,1,0,0,0,.92-.66l8-22A1,1,0,0,0,27.71,4.29Z\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    id: \"_Transparent_Rectangle_\",\n    \"data-name\": \"<Transparent Rectangle>\",\n    className: \"cls-1\",\n    width: 32,\n    height: 32\n  })));\n}\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSend);\nexport default __webpack_public_path__ + \"static/media/send.e6e41f470c70eedfe79bcc21222a7720.svg\";\nexport { ForwardRef as ReactComponent };","import { doc, getFirestore, updateDoc } from 'firebase/firestore';\r\nimport { useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport send from '../../img/send.svg';\r\nimport style from './MessagesMain.module.css';\r\n\r\n\r\n\r\nexport function SendMessages({setSizeWindow, sendMess, text, setMessageText, handleEvent, innerRef, infoChat}) {\r\n    const myInfo = useSelector(state => state.user)\r\n    const db = getFirestore()\r\n\r\n    useEffect(() =>{\r\n        window.addEventListener(\"resize\", keyboardDidShow )\r\n        function keyboardDidShow() {\r\n            const newHeight = window.visualViewport.height;\r\n            setSizeWindow(newHeight)\r\n        }\r\n        return () =>{\r\n            keyboardDidShow()\r\n        }\r\n    }, [])\r\n\r\n    const delViewMess = async () => {\r\n        try{\r\n            await updateDoc(doc(db, 'chatsList', myInfo.id), {\r\n                [infoChat.id + '.viewNewMessage'] :{\r\n                    viewNewMess: true\r\n                }\r\n            })\r\n            await updateDoc(doc(db, 'chatsList', infoChat.friendId), {\r\n                [infoChat.id + '.viewMessage']: {\r\n                    view: true, \r\n                }\r\n            })\r\n        } catch(err){\r\n            console.error(err)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <section className={style.textArea} ref={innerRef}>\r\n            {/* change click 'Enter your message'onFocus={() => keyboardIsOpen()}*/}\r\n            <textarea onClick={() => delViewMess()} placeholder='Enter your message' onKeyDown={handleEvent} value={text} onChange={(e) => setMessageText(e.target.value)} name=\"messages\" id='textarea' type='text' className={style.input} rows=\"1\" ></textarea>\r\n            <button onClick={() => sendMess()} type='submit' className={style.send}>\r\n                <img src={send} alt=\"Send\" />\r\n            </button>\r\n        </section>\r\n    )\r\n}","import classNames from \"classnames\"\r\nimport { doc, getFirestore, onSnapshot } from \"firebase/firestore\";\r\nimport { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addMessage } from \"../../store/messagesSlice\";\r\nimport style from './MessagesMain.module.css'\r\n\r\n\r\nexport function MessagesFieldMe({ setSizeWindow, infoChat, scrollRef}) {\r\n  \r\n    const messagesState = useSelector(state => state.message.messages)\r\n    const user = useSelector(state => state.user)\r\n    const findChat = messagesState.find(el => el.chatId === infoChat.id)\r\n\r\n    const db = getFirestore()\r\n    const dispatch = useDispatch()\r\n    const dayArr = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']\r\n\r\n\r\n    useEffect(() => {\r\n        scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n    }, [messagesState])\r\n\r\n    \r\n    useEffect(()=>{\r\n        window.addEventListener(\"onload\", setSizeWindow(window.visualViewport.height));\r\n    \r\n        return () => window.addEventListener(\"resize\", setSizeWindow(window.visualViewport.height));        \r\n    },[messagesState, window.innerHeight])\r\n\r\n\r\n    useEffect(() => {\r\n        //console.log('w')\r\n        const unsub = onSnapshot(doc(db, 'chats', infoChat.id), (doc) => {\r\n            //console.log('ww')\r\n            if (doc.data()) {\r\n                //console.log('www')\r\n                const data = doc.data()\r\n                const chatId = infoChat.id\r\n\r\n                data.messages.map(el => {\r\n                    const userId = el.userId\r\n                    const messageText = el.messageText\r\n                    const messageId = el.id\r\n                    const date = el.date\r\n                    const dayMess = dayArr[date.toDate().getDay()]//\r\n                    const hoursMess = date.toDate().getHours()//\r\n                    let minute = date.toDate().getMinutes().toString()//\r\n                    if(minute.length === 1){\r\n                        minute = `0${minute}`\r\n                    }\r\n                    const datePush = `${dayMess} ${hoursMess}:${minute}`\r\n\r\n                    dispatch(addMessage({ chatId, userId, messageText, datePush, messageId }))\r\n\r\n                })\r\n            } else {\r\n                return false\r\n            }\r\n        })\r\n\r\n        return () => {\r\n            unsub()\r\n        }\r\n    }, [infoChat.id])\r\n\r\n\r\n\r\n    return (\r\n\r\n        (messagesState.length > 0 && findChat ? (findChat.messages.map(el => (\r\n\r\n            el.userId === user.id ? (\r\n                <div key={el.messageId} className={style.messageContainerMe}>\r\n                    <span className={classNames(\"message\", style.messagesMe)}>\r\n                        {el.text}\r\n                        <span className={classNames(style.dateMessages, style.dateMe)}>{el.date}</span>\r\n                    </span>\r\n                    \r\n                </div>\r\n            ):(\r\n                <div key={el.messageId} className={style.messageContainerFriend}>\r\n                    <span className={classNames(\"message\", style.messagesFriend)}>\r\n                        {el.text}\r\n                        <span className={classNames(style.dateMessages, style.dateFriend)}>{el.date}</span>\r\n                    </span>\r\n                    \r\n                </div>\r\n            )\r\n        ))) : (\r\n            <div className={classNames(style.empty)}>No Messages</div>\r\n        ))\r\n    );\r\n}","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { useOutletContext, useParams } from 'react-router-dom';\r\nimport style from './MessagesMain.module.css';\r\nimport classNames from 'classnames';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useRef, useState } from 'react';\r\nimport { SendMessages } from './SendMessages';\r\nimport { MessagesFieldMe } from './MessagesFieldMe';\r\nimport { arrayUnion, doc, getDoc, getFirestore, onSnapshot, serverTimestamp, Timestamp, updateDoc } from 'firebase/firestore';\r\nimport { v4 as uuid } from 'uuid';\r\nimport img from '../../img/user-M.png'\r\nimport { useEffect } from 'react';\r\nimport { updatePhotoName, viewMessage } from '../../store/friendSlice';\r\n\r\n\r\n\r\nexport default function MessagesMain() {\r\n    const friend = useSelector(state => state.friend.friend)\r\n    const user = useSelector(state => state.user)\r\n\r\n    const nameRef = useRef();\r\n    const scrollRef = useRef();\r\n    const footerRef = useRef();\r\n\r\n    const db = getFirestore()\r\n\r\n    const [link] = Object.values(useParams())\r\n    const infoChat = friend.find(el => el.id === link)\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const [sizeWindow, setSizeWindow] = useState(window.visualViewport.height)//can change for reducer\r\n    const [deletedAcc, setDeletedAcc] = useState(false)\r\n    const [text, setMessageText] = useState('');\r\n\r\n    const sendMess = async () => {\r\n        const messageText = text\r\n        setMessageText('')\r\n\r\n        if (messageText !== '') {\r\n            const messageId = uuid()\r\n            const date = Timestamp.now()\r\n\r\n            await updateDoc(doc(db, 'chats', infoChat.id), {\r\n                messages: arrayUnion({\r\n                    id: messageId,\r\n                    messageText,\r\n                    userId: user.id,\r\n                    date: date\r\n                })\r\n            })\r\n\r\n            await updateDoc(doc(db, 'chatsList', user.id), {\r\n                [infoChat.id + '.lastMessage']: {\r\n                    messageText\r\n                },\r\n                [infoChat.id + '.date']: serverTimestamp(),\r\n                [infoChat.id + '.viewMessage'] :{\r\n                    view: false,\r\n                },\r\n                [infoChat.id + '.idSender'] :{\r\n                    idSender:user.id\r\n                },\r\n                [infoChat.id + '.viewNewMessage'] :{\r\n                    viewNewMess: true\r\n                }\r\n\r\n            })\r\n\r\n            const res = await getDoc(doc(db, 'chatsList', infoChat.friendId))\r\n\r\n            if (res.exists()) {\r\n                await updateDoc(doc(db, 'chatsList', infoChat.friendId), {\r\n                    [infoChat.id + '.lastMessage']: {\r\n                        messageText\r\n                    },\r\n                    [infoChat.id + '.date']: serverTimestamp(),\r\n                    [infoChat.id + '.viewMessage'] :{\r\n                        view: false,\r\n                    },\r\n                    [infoChat.id + '.idSender'] :{\r\n                        idSender:user.id\r\n                    },\r\n                    [infoChat.id + '.viewNewMessage'] :{\r\n                        viewNewMess: false\r\n                    }\r\n                })\r\n            }\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n    const handleEvent = (e) => {\r\n\r\n        if (e.code === 'Enter' && e.ctrlKey === false && e.shiftKey === false) {\r\n            e.preventDefault()\r\n            sendMess()\r\n        }\r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        const unsub = onSnapshot(doc(db, \"chatsList\", user.id), (doc) => {\r\n            const data = Object.entries(doc.data())\r\n\r\n            if (data) {\r\n                const findChat = data.find(el => el[0] === infoChat.id)\r\n\r\n                if (findChat) {\r\n                    const combinedId = findChat[0]\r\n                    const friendInfo = infoChat.id\r\n                    const name = findChat[1].userInfo.displayName ? findChat[1].userInfo.displayName : ''\r\n                    const photo = findChat[1].userInfo.photo\r\n                    const view = findChat[1].viewMessage.view \r\n                    const idSender = findChat[1].idSender ? findChat[1].idSender.idSender : null\r\n                    const newMess = findChat[1].viewNewMessage.viewNewMess \r\n                    //console.log(findChat)\r\n\r\n                    if (findChat[1].userInfo.acc === 'deleted') {\r\n                        dispatch(updatePhotoName({ name, photo, friendInfo }))\r\n                        setDeletedAcc(true)\r\n                        return\r\n                    } else {\r\n                        dispatch(updatePhotoName({ name, photo, friendInfo }))\r\n                        setDeletedAcc(false)\r\n                    }\r\n\r\n                    dispatch(viewMessage({newMess, view,combinedId,idSender}))\r\n                }\r\n            }\r\n\r\n        });\r\n        return () => {\r\n            unsub()\r\n        }\r\n    }, [friend.name, friend.photo, friend.email])\r\n\r\n    useEffect(()=>{\r\n        if (scrollRef.current !== null) {\r\n            const nameHeight = nameRef.current.offsetHeight\r\n            const footerHeight = footerRef.current.offsetHeight\r\n            const windowHeight = window.visualViewport.height\r\n\r\n            const sum =   nameHeight + footerHeight\r\n\r\n            const res = windowHeight - sum\r\n\r\n            scrollRef.current.style.height = `${res}px`\r\n            scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n        }\r\n\r\n    }, [sizeWindow])\r\n\r\n    return (\r\n        <section className={style.messagesSec}>\r\n            <div className={classNames(style.container, 'container')}>\r\n                <header className={style.header} ref={nameRef}>\r\n                    <div className={style.user}>\r\n                        <div className={style.userImg}>\r\n                            <img src={infoChat.photo !== null ? infoChat.photo : img} alt=\"User\" />\r\n                        </div>\r\n                        <div className={style.about}>\r\n                            <h2 className={style.name}>\r\n                                {infoChat.name}\r\n                            </h2>\r\n                        </div>\r\n\r\n                    </div>\r\n                </header>\r\n\r\n                <section ref={scrollRef} id='scroll' className={style.messages}>\r\n                    <MessagesFieldMe setSizeWindow={setSizeWindow} scrollRef={scrollRef} infoChat={infoChat}></MessagesFieldMe>\r\n                </section>\r\n                {deletedAcc\r\n                    ?\r\n                    <div ref={footerRef} className={classNames(style.deletedInput)}>Account has been deleted</div>\r\n                    :\r\n                    <SendMessages infoChat={infoChat} scrollRef={scrollRef} setSizeWindow={setSizeWindow}  innerRef={footerRef} handleEvent={handleEvent} sendMess={sendMess} text={text} setMessageText={setMessageText} />\r\n                }\r\n            </div>\r\n        </section>\r\n    );\r\n\r\n}"],"names":["SendMessages","setSizeWindow","sendMess","text","setMessageText","handleEvent","innerRef","infoChat","myInfo","useSelector","state","user","db","getFirestore","useEffect","keyboardDidShow","newHeight","window","visualViewport","height","addEventListener","delViewMess","updateDoc","doc","id","viewNewMess","friendId","view","console","error","className","style","ref","onClick","placeholder","onKeyDown","value","onChange","e","target","name","type","rows","src","send","alt","MessagesFieldMe","scrollRef","messagesState","message","messages","findChat","find","el","chatId","dispatch","useDispatch","dayArr","current","scrollTop","scrollHeight","innerHeight","unsub","onSnapshot","data","map","userId","messageText","messageId","date","dayMess","toDate","getDay","hoursMess","getHours","minute","getMinutes","toString","length","datePush","addMessage","classNames","getRandomValues","randomUUID","crypto","bind","rnds8","Uint8Array","rng","Error","byteToHex","i","push","slice","unsafeStringify","arr","offset","toLowerCase","options","buf","native","rnds","random","MessagesMain","friend","nameRef","useRef","footerRef","Object","values","useParams","link","useState","sizeWindow","deletedAcc","setDeletedAcc","uuid","Timestamp","arrayUnion","serverTimestamp","idSender","getDoc","exists","entries","combinedId","friendInfo","userInfo","displayName","photo","viewMessage","newMess","viewNewMessage","acc","updatePhotoName","email","nameHeight","offsetHeight","footerHeight","res","img","code","ctrlKey","shiftKey","preventDefault"],"sourceRoot":""}